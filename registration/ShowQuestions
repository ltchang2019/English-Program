<?php

session_start();
$user = $_SESSION['username'];
//See original: https://www.w3schools.com/php/php_mysql_connect.asp
$servername = "localhost";
$username = "root";
$password = "";
$dbName = "English Program";

try {
    $conn = new PDO("mysql:host=$servername;dbname=$dbName", $username, $password);

    // set the PDO error mode to exception
    $conn->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);

    $sql = "SELECT * FROM Users WHERE username = '$user'";
    $statement = $conn -> query($sql);

    foreach($statement as $row){
        $groupNumber = $row["groupNumber"];
        break;
    }

    $textName = $_GET["textName"];

    $sql = "SELECT * FROM Questions WHERE text = '$textName' AND groupNumber = '$groupNumber' ";
    $statement = $conn -> query($sql);


    if ($statement -> rowCount() == 0) {
        print "<style> table, th, td { border: 0px solid black;} #center { margin-left: auto; margin-right: auto;}</style>";
        print "<div id='center'><table id='center'><th><br><h4>" . "No new questions have been posted..." . "</h4></th>";
    }
    else{
    print "<style> table, th, td {width: 300px; border: 1px solid black; text-align: center;} #center { margin-left: auto; margin-right: auto;}</style>";
    print "<div id='center'><table id='center'><tr><th>Number</th><th>Question</th></tr>";

    $varNumb = 1;
    foreach($statement as $row){
    	$question = $row["question"];
    
        print "<tr>";
        print "<td>" . $varNumb . "</td>";
        print "<td>" . $question . "</td>";
        print "</tr>";

        $varNumb++;
    }
        print "</table></div>";
    }

}
catch(PDOException $e) {
    print "Connection failed: " . $e->getMessage();
}
?>
